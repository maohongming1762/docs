# Huawei Cloud Stack(HCS) 无代理模式

## 兼容性

| 模块                             | 版本                     |
| -------------------------------- | ------------------------ |
| Huawei Cloud Stack(HCS) 云平台   | 8.0.2                    |
| Huawei Cloud Stack(HCS) 存储类型 | OceanStor Dorado 8000 V6 |

::: warning
注意：目前华为云（HCS）8.2.x / 8.3.x 的 API 与华为云（HCS）8.0.2 有显著差异，因此暂不支持华为云（HCS）8.2.x / 8.3.x。

其他 Dorado 存储型号尚未适配。
:::

## 客户机操作系统支持

点击 [无代理支持列表](https://oneprocloud.feishu.cn/sheets/VRqksSPEPhRTPStp3kVcItXNnyh?sheet=0MJNYC) 查看兼容性列表和最新支持状态。

## 支持与限制

### 1. 网络要求

为确保数据同步正常进行：

- 必须在生产环境的 HCS 中部署一台或多台虚拟机，用于与 Dorado 存储控制网络通信。这些虚拟机必须保持与 Dorado API 接口和 APIG（API 网关）标准接口的稳定正常访问。

### 2. API 接口要求

需要以下接口权限：

#### HCS 接口权限

| 序号 | 接口描述                 |
| ---- | ------------------------ |
| 1    | 认证接口                 |
| 2    | 查询云服务器详情         |
| 3    | 查询云服务器详情列表     |
| 4    | 查询弹性云服务器磁盘信息 |
| 5    | 查询云服务器规格详情列表 |
| 6    | 查询云硬盘类型列表       |
| 7    | 创建云硬盘快照           |
| 8    | 获取云硬盘快照           |
| 9    | 删除云硬盘快照           |
| 10   | 创建云硬盘               |
| 11   | 获取云硬盘               |
| 12   | 挂载云硬盘               |
| 13   | 卸载云硬盘               |
| 14   | 删除云硬盘               |

#### Dorado 接口权限

| 序号 | 接口描述                              |
| ---- | ------------------------------------- |
| 1    | 访问认证                              |
| 2    | 查询 LUN 与快照之间非共享块的位图信息 |
| 3    | 激活快照                              |

### 3. 限制条件

#### 存储类型限制

- 仅支持使用 Dorado 存储（如 OceanStor Dorado 8000 V6）作为磁盘存储的主机。不支持使用分布式存储（Pacific）作为磁盘存储的主机。

#### 最大快照限制

- HCS 中每个磁盘最多支持 128 个快照。如果磁盘快照数量达到此限制，将无法创建新的快照，导致同步任务失败。

#### 并发限制

- 每个源端同步代理（Sync Proxy）最多可同时同步 23 个磁盘，此限制是由 HCS 平台每台主机最多挂载 24 个 VBD 类型磁盘的能力所决定。
- 当同步的磁盘数量超过 23 个时，额外的磁盘任务将被放入等待队列，并在当前同步任务完成后按顺序执行。
- 队列中的最长等待时间为 1 小时。如果任务在超时期限后仍未开始执行，相应的同步任务可能会失败。
